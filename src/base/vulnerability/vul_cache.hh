#ifndef __VUL_CACHE_HH__
#define __VUL_CACHE_HH__

#include "mem/packet.hh"
#include "mem/cache/blk.hh"
#include "base/vulnerability/vul_main.hh"

class CacheVulCalc {

public:
    
    CacheVulCalc(int cacheline, int protMode);
    
    void vulOnInsert(CacheBlk *blk);

    long vulOnRead(CacheBlk *blk, PacketPtr pkt);

    void vulOnWrite(CacheBlk *blk, PacketPtr pkt);

    long vulOnEvict(CacheBlk *blk);

private:
    
    int cacheLineSize;
    
    int numWords;

    int protectionMode;
     
    Tick getRecent(CacheBlk *blk);

    bool isTarget(PacketPtr pkt, unsigned wordIdx);
};

#endif      //__VUL_CACHE_HH__
