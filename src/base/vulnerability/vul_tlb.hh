/**
  * @file
  * TLB Vulnerability evaluation functions
  *
  */


#ifndef __VUL_TLB_HH__
#define __VUL_TLB_HH__

#include "base/vulnerability/vul_main.hh"
#include "arch/arm/tlb.hh"
#include "arch/arm/pagetable.hh"

namespace ArmISA {

#define FLUSH_ALL 0
#define FLUSH_ASID 1
#define FLUSH_MVA_ASID 2
#define FLUSH_MVA 3

class TlbVulCalc {

public:
    
    void vulOnRead(TLB *tlb, Addr va);

    void vulOnIncoming(TlbEntry *e);

    void vulOnFlush(TLB *tlb, TlbEntry *e, int flushop, uint64_t asn, Addr mva);

};

}          //namespace ArmISA

#endif          //__VUL_TLB_HH__
