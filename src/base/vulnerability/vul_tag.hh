#ifndef __VUL_TAG_HH__
#define __VUL_TAG_HH__

#include "base/vulnerability/vul_main.hh"
#include "mem/cache/blk.hh"
#include "mem/cache/tags/cacheset.hh"
#include "base/intmath.hh"

template <class CacheBlk>
class CacheSet;

class TagVulCalc {

private:
    int tag_size;
    
public:

    void init(int cachelineSize, int numSets)
    {
        tag_size = TAG_BITS + ADDRESS_SPACE_SIZE - (floorLog2(cachelineSize) + floorLog2(numSets));
    }

    void vulOnInsert(CacheBlk *blk);

    void vulOnAccess(CacheSet<CacheBlk> *set, Addr tag);

    long vulOnEvict(CacheBlk *blk);

};

#endif      //__VUL_TAG_HH__
